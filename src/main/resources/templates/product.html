<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title th:text="${pageTitle}"></title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" >
    <link rel="stylesheet" href="/style/main-style.css">
</head>
<body>
<header>
    <div id="navbar"></div>
    <div th:replace="~{fragments/navigation-main :: navbar}"></div>
</header>
<div class="container mt-5">
    <div class="row">
        <!-- Слайдер изображений -->
        <div class="col-md-6 d-flex flex-column justify-content-center">
            <div id="productCarousel" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner" style="max-height: 500px; overflow: hidden;">
                    <th:block th:each="photo, iterStat : ${photoPaths}">
                        <div class="carousel-item" th:classappend="${iterStat.first} ? 'active'">
                            <img th:src="@{${photo}}" class="d-block mx-auto" alt="Product Image" style="max-height: 500px; object-fit: contain;">
                        </div>
                    </th:block>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#productCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                </button>
            </div>

            <!-- Предпросмотр изображений -->
            <div class="mt-2 d-flex justify-content-center">
                <div class="preview-scroll-container d-flex overflow-auto" style="max-width: 100%; gap: 0.5rem;">
                    <th:block th:each="photo, iterStat : ${photoPaths}">
                        <img th:src="@{${photo}}" class="preview-thumbnail" alt="Thumbnail"
                             style="width: 80px; height: 80px; object-fit: contain; cursor: pointer;"
                             th:data-index="${iterStat.index}"
                             onclick="setActiveSlide(this.dataset.index)">
                    </th:block>
                </div>
            </div>
        </div>


        <!-- Информация о товаре -->
        <div class="col-md-6">
            <h1 th:text="${product.name}"></h1>
            <p class="text-secondary" th:text="${product.feature}"></p>
            <div class="d-flex align-items-center">
                <h3 class="me-3" th:text="${product.group.price + ' €'}"></h3>
                <button class="btn btn-primary">Добавить в корзину</button>
            </div>

            <!-- Выбор варианта товара -->
            <div class="mt-3">
                <h5>Выберите цвет:</h5>
                <div class="d-flex flex-wrap gap-2">
                    <a th:each="variant : ${variants}" th:href="@{/product/{id}(id=${variant.id})}" class="btn btn-outline-primary me-2" th:text="${variant.feature}"></a>
                </div>
            </div>
            <div class="mt-5">
                <h4>Описание</h4>
                <p th:text="${product.group.description}"></p>
                <h5>Характеристики</h5>
                <ul>
                    <li><strong>Материал:</strong> <span th:text="${product.group.material.name}"></span></li>
                    <li><strong>Размер:</strong> <span th:text="${product.group.size}"></span></li>
                </ul>
            </div>

        </div>
    </div>
</div>

</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    function setActiveSlide(index) {
        const carouselItems = document.querySelectorAll('#productCarousel .carousel-item');
        carouselItems.forEach(item => item.classList.remove('active'));
        carouselItems[index].classList.add('active');

        const thumbnails = document.querySelectorAll('.preview-thumbnail');
        thumbnails.forEach(thumb => thumb.classList.remove('active'));
        thumbnails[index].classList.add('active');
    }

    document.getElementById('productCarousel').addEventListener('slid.bs.carousel', function (e) {
        const index = e.to;
        const thumbnails = document.querySelectorAll('.preview-thumbnail');
        thumbnails.forEach(thumb => thumb.classList.remove('active'));
        if (thumbnails[index]) {
            thumbnails[index].classList.add('active');
        }
    });

    document.addEventListener('DOMContentLoaded', () => {
        const firstThumb = document.querySelector('.preview-thumbnail');
        if (firstThumb) firstThumb.classList.add('active');
    });
</script>
</html>